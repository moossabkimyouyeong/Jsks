<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Roblox Avatar Check</title>
<style>
    body{margin:0;padding:0;background:#E3E5E8;
         font-family:Arial;display:flex;justify-content:center;
         align-items:center;height:100vh;}
    .box{width:360px;background:white;padding:25px;border-radius:12px;
         text-align:center;box-shadow:0 0 15px rgba(0,0,0,0.15);}
    input,button{width:100%;padding:12px;border-radius:10px;font-size:16px;}
    input{border:1px solid #ccc;background:#F2F3F5;margin-top:10px;}
    button{border:none;background:#00A2FF;color:white;margin-top:15px;font-weight:bold;}
    #avatar{width:140px;height:140px;border-radius:12px;border:2px solid #ddd;display:none;margin:15px auto;}
    .step{display:none;} .show{display:block;}
</style>
</head>
<body>

<div class="box">

    <!-- STEP 1 -->
    <div id="step1" class="step show">
        <h2>Step 1 — Username</h2>
        <input id="username" placeholder="Roblox Username">
        <button onclick="loadAvatar()">Next</button>
    </div>

    <!-- STEP 2 -->
    <div id="step2" class="step">
        <h2>Step 2 — Confirm Avatar</h2>
        <img id="avatar">
        <h3 id="name"></h3>
        <button onclick="goStep3()">Yes, this is me</button>
        <button style="background:#bbb;color:#333;" onclick="retry()">No, go back</button>
    </div>

    <!-- STEP 3 -->
    <div id="step3" class="step">
        <h2>Step 3 — Select Robux</h2>
        <select id="robux">
            <option value="">Choose</option>
            <option>400 Robux</option><option>800 Robux</option>
            <option>1700 Robux</option><option>4500 Robux</option><option>10000 Robux</option>
        </select>
        <button onclick="finish()">Generate</button>
    </div>

    <!-- STEP 4 -->
    <div id="step4" class="step">
        <h2>Processing…</h2>
        <p>✅ Completed!</p>
    </div>

</div>

<script>
async function loadAvatar() {
    const name = username.value.trim();
    if (!name) return alert("Enter name");

    // 1) username → userId (공식 API는 fetch 가능)
    const res = await fetch("https://users.roblox.com/v1/usernames/users", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({usernames:[name]})
    });
    const data = await res.json();
    if (!data.data || !data.data[0] || !data.data[0].id)
        return alert("User not found");

    const userId = data.data[0].id;

    // ✅ 2) img src 직접 세팅 (CORS 없음, 무조건 뜸)
    const directURL =
        `https://www.roblox.com/headshot-thumbnail/image?userId=${userId}&width=150&height=150&format=png`;

    avatar.src = directURL;
    avatar.style.display = "block";
    nameBox = document.getElementById("name");
    nameBox.innerText = name;

    step1.classList.remove("show");
    step2.classList.add("show");
}

function goStep3(){
    step2.classList.remove("show");
    step3.classList.add("show");
}

function retry(){
    step2.classList.remove("show");
    step1.classList.add("show");
}

function finish(){
    step3.classList.remove("show");
    step4.classList.add("show");
}
</script>

</body>
</html>
    input, select {
        width: 100%;
        padding: 12px;
        margin-top: 12px;
        border: 1px solid #C3C4C6;
        border-radius: 8px;
        font-size: 16px;
        background: #F2F3F5;
    }

    button {
        width: 100%;
        padding: 14px;
        margin-top: 20px;
        background: #00A2FF; /* Roblox 파란 버튼 */
        border: none;
        color: white;
        border-radius: 8px;
        font-size: 17px;
        cursor: pointer;
    }

    button:hover {
        background: #0086D6;
    }

    /* Step pages */
    .step { display: none; }
    .active { display: block; }

    /* Avatar */
    #avatarImg {
        width: 120px;
        height: 120px;
        border-radius: 10px;
        margin: 12px auto;
        display: none;
        border: 2px solid #E3E5E8;
    }

    #avatarName {
        font-size: 16px;
        margin-top: 6px;
        display: none;
    }

    /* Loading steps */
    .loadstep {
        opacity: 0.3;
        margin: 8px 0;
    }

    .highlight {
        opacity: 1;
        font-weight: bold;
        color: #00A2FF;
    }
</style>
</head>
<body>

<div class="container">

    <!-- STEP 1 -->
    <div id="step1" class="step active">
        <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/1/16/Roblox_Logo_2022.png">
        <h2>Step 1 — Enter Username</h2>

        <img id="avatarImg">
        <div id="avatarName"></div>

        <input id="username" type="text" placeholder="Roblox Username" onblur="loadAvatar()">
        <button onclick="nextStep2()">Next</button>
    </div>

    <!-- STEP 2 -->
    <div id="step2" class="step">
        <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/1/16/Roblox_Logo_2022.png">
        <h2>Step 2 — Select Robux</h2>

        <select id="robux">
            <option value="">Choose</option>
            <option value="400">400 Robux</option>
            <option value="800">800 Robux</option>
            <option value="1700">1700 Robux</option>
            <option value="4500">4500 Robux</option>
            <option value="10000">10000 Robux</option>
        </select>

        <button onclick="nextStep3()">Generate</button>
    </div>

    <!-- STEP 3 -->
    <div id="step3" class="step">
        <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/1/16/Roblox_Logo_2022.png">
        <h2>Processing…</h2>

        <div id="l1" class="loadstep">Connecting...</div>
        <div id="l2" class="loadstep">Checking username...</div>
        <div id="l3" class="loadstep">Applying package...</div>
        <div id="l4" class="loadstep">Finalizing...</div>
        <div id="l5" class="loadstep">✅ Completed!</div>
    </div>

</div>

<script>
// ✅ Step 이동
function nextStep2() {
    if (!username.value) return alert("Enter username");
    step1.classList.remove("active");
    step2.classList.add("active");
}

function nextStep3() {
    if (!robux.value) return alert("Select Robux amount");
    step2.classList.remove("active");
    step3.classList.add("active");

    // 단계별 로딩 진행
    let i = 1;
    function run() {
        document.getElementById("l" + i).classList.add("highlight");
        i++;
        if (i <= 5) setTimeout(run, 900);
    }
    run();
}

// ✅ 아바타 로딩 (로컬에서도 100% 작동하는 프록시 방식)
async function loadAvatar() {
    const name = username.value.trim();
    if (!name) return;

    // 1) username → userId
    const res = await fetch("https://users.roblox.com/v1/usernames/users", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({usernames: [name]})
    });
    const data = await res.json();
    if (!data.data || !data.data[0].id) {
        avatarName.innerText = "User not found";
        avatarName.style.display = "block";
        avatarImg.style.display = "none";
        return;
    }

    const userId = data.data[0].id;

    // 2) userId → 프록시 서버에서 이미지 가져옴 (로컬에서도 작동)
    const imgUrl = `https://thumbnails.roproxy.com/v1/users/avatar-headshot?userIds=${userId}&size=150x150&format=Png`;

    avatarImg.src = imgUrl;
    avatarImg.style.display = "block";
    avatarName.innerText = name;
    avatarName.style.display = "block";
}
</script>

</body>
</html>    /* 공통 입력 / 버튼 */
    input, select {
        width: 100%;
        padding: 14px;
        margin-top: 15px;
        border-radius: 10px;
        border: none;
        font-size: 16px;
        outline: none;
    }

    button {
        width: 100%;
        padding: 15px;
        margin-top: 20px;
        background: white;
        color: #1565C0;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        font-weight: bold;
    }

    button:hover {
        background: #e8e8e8;
    }

    /* 아바타 */
    #avatarImg {
        width: 120px;
        height: 120px;
        border-radius: 14px;
        border: 3px solid white;
        display: none;
        margin: 10px auto;
    }

    #avatarName {
        display: none;
        margin-top: 8px;
        font-weight: bold;
        font-size: 16px;
    }

    /* 숨김 */
    .hidden {
        display: none;
    }

    /* 로딩 텍스트 */
    .step {
        opacity: 0.3;
        margin-top: 8px;
        font-size: 16px;
    }
    .active {
        opacity: 1;
        font-weight: bold;
    }
</style>
</head>
<body>

<div class="box">

    <!-- STEP 1: Username & Avatar -->
    <div id="step1">
        <h2>Step 1. Enter Username</h2>

        <img id="avatarImg">
        <div id="avatarName"></div>

        <input type="text" id="username" placeholder="Roblox Username" onblur="loadAvatar()">
        <button onclick="goStep2()">Next</button>
    </div>

    <!-- STEP 2: Robux Amount -->
    <div id="step2" class="hidden">
        <h2>Step 2. Select Robux</h2>

        <select id="robux">
            <option value="">Choose Amount</option>
            <option value="400">400 Robux</option>
            <option value="800">800 Robux</option>
            <option value="1700">1,700 Robux</option>
            <option value="4500">4,500 Robux</option>
            <option value="10000">10,000 Robux</option>
        </select>
        <button onclick="goStep3()">Next</button>
    </div>

    <!-- STEP 3: Loading -->
    <div id="step3" class="hidden">
        <h2>Step 3. Processing</h2>

        <div class="step" id="l1">Connecting...</div>
        <div class="step" id="l2">Checking username...</div>
        <div class="step" id="l3">Applying Robux...</div>
        <div class="step" id="l4">Finalizing...</div>
        <div class="step" id="l5">✅ Completed!</div>
    </div>

</div>

<script>
// ✅ STEP 이동
function goStep2() {
    if (!document.getElementById("username").value) {
        alert("Enter username first.");
        return;
    }
    step1.style.display = "none";
    step2.style.display = "block";
}

function goStep3() {
    if (!document.getElementById("robux").value) {
        alert("Select Robux amount.");
        return;
    }
    step2.style.display = "none";
    step3.style.display = "block";

    // 로딩 진행
    let current = 1;
    function showNext() {
        document.getElementById("l" + current).classList.add("active");
        current++;
        if (current <= 5) setTimeout(showNext, 900);
    }
    showNext();
}

// ✅ 아바타 자동 로딩
async function loadAvatar() {
    const username = document.getElementById("username").value.trim();
    const img = document.getElementById("avatarImg");
    const nameBox = document.getElementById("avatarName");

    if (!username) return;

    // Username → UserId
    let res = await fetch("https://users.roblox.com/v1/usernames/users", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ usernames: [username] })
    });

    let data = await res.json();

    if (!data.data || !data.data[0].id) {
        img.style.display = "none";
        nameBox.style.display = "block";
        nameBox.innerHTML = "❌ User not found";
        return;
    }

    let userId = data.data[0].id;

    // UserId → Avatar
    let avatar = await fetch(
        `https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${userId}&size=150x150&format=Png`
    );

    let avatarData = await avatar.json();

    img.src = avatarData.data[0].imageUrl;
    img.style.display = "block";

    nameBox.innerHTML = username;
    nameBox.style.display = "block";
}
</script>

</body>
</html>
